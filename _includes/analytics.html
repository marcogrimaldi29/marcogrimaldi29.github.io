<!-- jekyll.environment == "production" prevents tracking during local jekyll serve. When testing locally, set JEKYLL_ENV=production to test -->
{%- if site.ga_measurement_id and jekyll.environment == "production" -%}
<!-- Google tag (gtag.js) - GDPR-friendly / cookieless configuration -->
<script async src="https://www.googletagmanager.com/gtag/js?id={{ site.ga_measurement_id }}"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  // Configure GA4 with privacy settings
  gtag('config', '{{ site.ga_measurement_id }}', {
    'anonymize_ip': true,              // Hide the last octet of the visitor's IP
    'allow_ad_personalization_signals': false, // Disable ad personalization
    'allow_google_signals': false,     // Prevent cross-site tracking / remarketing
    'storage': 'none',                 // ‚ùó disables cookies for analytics
    'client_storage': 'none',          // newer GA4 key; ensures no cookies/localStorage
    'debug_mode': false                // optional: turn on only for debugging
  });
</script>
{%- endif -%}
